<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title>Median Household Incomes in the Greater Horseshoe Region</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />

<style>

body { margin:0; padding:0; }

#map { position:absolute; top:0; bottom:0; width:100%; }

.map-overlay { position: relative; top: 15px; left: 15px; bottom: 15px; width: 250px; background: rgba(255, 255, 255, 0.8); font-family: "Arial"; padding-left: 10px;}

#sidebar{position: absolute; top: 0; height: 500px; margin-top: 20px; width: 250px; }

#legend{position: absolute; top: 520px; line-height: 18px; height: 250px; margin-bottom: 40px; width:250px;}

.legend-key {display: inline-block; border-radius: 20%; width: 10px; height: 10px;  margin-right: 5px;
}

</style>

</head>

<body>
 
<div id='map'></div>   
<div class = 'map-overlay' id='sidebar'>
    <h1>Median Household Incomes in the Greater Horseshoe Region</h1>
    <div id="tooltip-name"></div>
    <div id='tooltip'></div>
    </div>
<div class = 'map-overlay' id='legend'></div>
<script>
// Import the customized map layer
mapboxgl.accessToken = 'pk.eyJ1Ijoic3VueWFuZzA0MjYiLCJhIjoiY2l2Mmh5Y2dxMDF1NzJ5cGhhazU5a3h1ciJ9.LChXuAo-sW2qS33wpha-rw';
const map = new mapboxgl.Map({
container: 'map',
style: 'mapbox://styles/sunyang0426/cjt5vscj90wly1fus5k0ysdkr', // This customized map style is generated by the Mapbox Studio.
center: [-79.7097161, 43.4135486],
zoom: 7.5
});

// Add interactivity to the map layer
map.on("mousemove", function (e) {
            var features = map.queryRenderedFeatures(e.point, {
                layers: ["household_incomes"]
            });

            if (features.length) {
                //show name and value in sidebar
                document.getElementById('tooltip-name').innerHTML = "This census tract is in " + features[0].properties.Refactor13 + " census division.";
                document.getElementById('tooltip').innerHTML = "It's median household income is " + features[0].properties.Refactor12 + " dollars, " + features[0].properties.Refactor17 + " " + features[0].properties.Refactor16 + " than that of " + features[0].properties.Refactor13 + " as a whole, which is " + features[0].properties.Refactor14 + ' dollars.';
                //for troubleshooting - show complete features info
                //document.getElementById('tooltip').innerHTML = JSON.stringify(features, null, 2);
            } else {
                //if not hovering over a feature set tooltip to empty
                document.getElementById('tooltip-name').innerHTML = "Hover over a colored cube!";
                document.getElementById('tooltip').innerHTML = "";
            }
        });

// Add legend to the map layer
map.on('load', function() {
  var layers = ['0-14489', '14489-17387', '17387-20285', '20285-28979', '28979-57958', '57958-86937', '86937-115916', '115916-231833', '231833-260813', '260813+'];
  var colors = ['#04418b', '#146aff', '#037377', '#07df68', '#b3ffd7', '#fbdd88', '#a69303', '#f76c26', '#d52c20', '#5f011c'];

  for (i = 0; i < layers.length; i++) {
  var layer = layers[i];
  var color = colors[i];
  var item = document.createElement('div');
  var key = document.createElement('span');
  key.className = 'legend-key';
  key.style.backgroundColor = color;

  var value = document.createElement('span');
  value.innerHTML = layer;
  item.appendChild(key);
  item.appendChild(value);
  legend.appendChild(item);
}
});


</script>
 
</body>
</html>